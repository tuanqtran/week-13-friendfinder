<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Friend Finder</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<!-- <style>
	body{
		background-image: url("./images/cork-wallet.png");
	}
</style> -->
<body style="background-image: url('/images/cork-wallet.png')">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<h2>Survey Questions</h2>
				<hr>
			</div>
		</div>
		<div class="row">
		    <form role="form">
		    	<div class="col-lg-12">
					<h3><strong>About You</strong></h3>
		    	</div>
		    	<div class="col-lg-12">
			        <div class="form-group">
			            <label for="requiredName"><h4>Name (Required)</h4></label>
			            <input type="text" class="form-control" id="requiredName" required>
			        </div>
			    </div>
		    	<div class="col-lg-12">
			        <div class="form-group">
			            <label for="photoImage"><h4>Link to Photo Image (Required)</h4></label>
			            <input type="text" class="form-control" id="photoImage" required>
			        </div>
		        </div>

		    	<div class="col-lg-12">
					<h3><strong>Question 1</strong></h3>
					<label for="question1"><h4>Your mind is always buzzing with unexplored ideas and plans.</h4></label>
					<select class="form-control" id="question1">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>

					<h3><strong>Question 2</strong></h3>
					<label for="question2"><h4>Generally speaking, you rely more on your experience than your imagination.</h4></label>
					<select class="form-control" id="question2">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>

					<h3><strong>Question 3</strong></h3>
					<label for="question3"><h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4></label>
					<select class="form-control" id="question3">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>

					<h3><strong>Question 4</strong></h3>
					<label for="question4"><h4>You rarely do something just out of sheer curiosity.</h4></label>
					<select class="form-control" id="question4">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 5</strong></h3>
					<label for="question5"><h4>People can rarely upset you.</h4></label>
					<select class="form-control" id="question5"><
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 6</strong></h3>
					<label for="question6"><h4>It is often difficult for you to relate to other people’s feelings.</h4></label>
					<select class="form-control" id="question6">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 7</strong></h3>
					<label for="question7"><h4>In a discussion, truth should be more important than people’s sensitivities.</h4></label>
					<select class="form-control" id="question7">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 8</strong></h3>
					<label for="question8"><h4>You rarely get carried away by fantasies and ideas.</h4></label>
					<select class="form-control" id="question8">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 9</strong></h3>
					<label for="question9"><h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4></label>
					<select class="form-control" id="question9">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
					
					<h3><strong>Question 10</strong></h3>
					<label for="question10"><h4>You feel more energetic after spending time with a group of people.</h4></label>
					<select class="form-control" id="question10">
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2">2 (Slightly Disagree)</option>
						<option value="3" selected="selected">3 (Neutral)</option>
						<option value="4">4 (Slightly Agree)</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<br>
		        <div class="col-lg-12">
		        	<button type="submit" class="btn btn-primary submit" style="width: 100%">Submit</button>
		        </div>
		    </form>
	    </div>
        <hr>
	    <footer class="footer">
	        <p>
	        	<a href="/api/friends" target="_blank">API Friends List</a> | 
	        	<a href="https://github.com/tuanqtran/week-13-friendfinder" target="_blank">GitHub Repo</a>
	        </p>
	    </footer>
	</div>
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Your new bestfriend is...</h4>
      </div>
      <div class="modal-body">
		<h3 id="userMatch"></h3>
		<div id="userPhoto"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

</body>
</html>
<script src="https://code.jquery.com/jquery.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script type="text/javascript">
	$(".submit").on("click", function(){
		var answerArray = [];
		answerArray.push($('#question1').val());
		answerArray.push($('#question2').val());
		answerArray.push($('#question3').val());
		answerArray.push($('#question4').val());
		answerArray.push($('#question5').val());
		answerArray.push($('#question6').val());
		answerArray.push($('#question7').val());
		answerArray.push($('#question8').val());
		answerArray.push($('#question9').val());
		answerArray.push($('#question10').val());

		var userInfo = {
			name: $('#requiredName').val().trim(),
			photo: $('#photoImage').val().trim(),
			score: answerArray
		};
		console.log(userInfo);

		$.get('/api/friends', function(req, res){
			var match;
			var potentialMatch = 0;
			var index = 0;
			function diffArray(){
				var difference = [];
				for(var j=0; j<req.length; j++){
					for(var i=0; i<userInfo.score.length; i++){
						potentialMatch += Math.abs(userInfo.score[i] - req[j].score[i]);
					}
					difference.push(potentialMatch);
					console.log(difference);
					match = Math.min.apply(Math, difference);

					console.log("This is the lowest value: " + match);
					potentialMatch = 0;
				}

				var index = difference.indexOf(match);
				$('#userMatch').html(req[index].name);
				$('#userPhoto').html('<img style="width:400px; height; 400px;"src="'+ req[index].photo + '" >');

				if($('.form-group .form-control') == ""){
					alert("Please try again.");
				}else{
					$('#myModal').modal('show'); 
				}				
			}
			diffArray();
		});

		$.post('/api/friends', userInfo, function(req, res){
			console.log(req);

		});


		return false;
	});
</script>
